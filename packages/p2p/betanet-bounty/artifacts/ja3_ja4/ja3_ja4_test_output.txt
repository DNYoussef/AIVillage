🔍 Betanet uTLS - JA3/JA4 Self-Test
=====================================

📋 Test 1: Chrome N-2 Stable (119.0.6045.123)
  Hostname: www.google.com
  TLS Version: 0x0303
  Cipher Suites: 8 total
  Extensions: 4 total
  GREASE Cipher: ✅ Present
  GREASE Extension: ✅ Present
  JA3: ac70771d34ad83a2b79f094506d57332
  JA4: th2120703h2_85c7cbb1a81272e45f38ec6f

📋 Test 2: Custom Chrome Profile
  Profile: Chrome 119.0.6045.123
  Hostname: example.com
  JA3: ac70771d34ad83a2b79f094506d57332
  JA4: th2120703h2_85c7cbb1a81272e45f38ec6f
  Consistency check: Different random -> Different fingerprints (expected)

📋 Test 3: JA3 vs JA4 Fingerprint Comparison
  JA3 Format: TLSVersion,CipherSuites,Extensions,EllipticCurves,EllipticCurvePointFormats
  JA3 Hash: ac70771d34ad83a2b79f094506d57332 (MD5)

  JA4 Format: q+ALPN+Version+CipherCount+ExtensionCount+ALPN_Extension+_+CiphersHash+ExtensionsHash
  JA4 String: th2120703h2_85c7cbb1a81272e45f38ec6f (SHA256-derived)
  JA4 Prefix: th2120703h2 (protocol + ALPN + version + counts)
  JA4 Hashes: 85c7cbb1a81272e45f38ec6f (24 chars)

  Key Differences:
    • JA3: Uses MD5 hash, includes all extension data
    • JA4: Uses SHA256 truncated, counts and sorted hashes
    • JA4: More resilient to extension reordering
    • JA4: Includes ALPN information explicitly

📋 Test 4: GREASE Value Impact on Fingerprints
  With GREASE:
    JA3: ac70771d34ad83a2b79f094506d57332
    JA4: th2120703h2_85c7cbb1a81272e45f38ec6f

  Without GREASE:
    JA3: ac70771d34ad83a2b79f094506d57332
    JA4: th2120703h2_85c7cbb1a81272e45f38ec6f

  GREASE Impact on JA4 Cipher Count:
    With GREASE: 20 ciphers
    Without GREASE: 20 ciphers
    ✅ GREASE values are properly filtered from count

📋 Test 5: Hostname Impact on Fingerprints
  Testing fingerprint consistency across different hostnames...
    example.com: JA3=ac70771d JA4=th2120703h2
    google.com: JA3=ac70771d JA4=th2120703h2
    github.com: JA3=ac70771d JA4=th2120703h2

  Analysis:
    • Hostname affects ServerName extension but not cipher/extension structure
    • JA3/JA4 structural elements should be consistent across hostnames
    • Random values in ClientHello cause fingerprint variation
    • JA4 prefix structure consistency: ✅ Consistent

✅ All tests completed successfully!

🎯 Key Findings:
   • Chrome N-2 stable ClientHello generation: ✅ Working
   • JA3 fingerprinting with GREASE filtering: ✅ Working
   • JA4 fingerprinting with sorted hashing: ✅ Working
   • Deterministic fingerprint generation: ✅ Working
   • GREASE value handling: ✅ Working
