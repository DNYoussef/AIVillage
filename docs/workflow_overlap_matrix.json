{
  "analysis_metadata": {
    "timestamp": "2025-08-31T14:30:00Z",
    "analyzer": "Code Review Swarm - Documentation Freshness CRAWL",
    "workflow_count": 5,
    "security_workflows_analyzed": [
      "security-scan.yml",
      "security-compliance.yml", 
      "scion_production.yml",
      "image-security-scan.yml",
      "main-ci.yml (security jobs)"
    ]
  },
  
  "workflow_overlap_matrix": {
    "security-scan.yml": {
      "jobs": [
        {
          "job_name": "python-security",
          "tools": ["pip-audit", "safety", "bandit", "semgrep", "cyclonedx-bom"],
          "overlap_with": {
            "security-compliance.yml": ["safety", "bandit", "semgrep"],
            "main-ci.yml": ["bandit", "safety", "semgrep"],
            "scion_production.yml": ["bandit", "safety"]
          },
          "unique_functions": ["cyclonedx-bom", "comprehensive reporting"]
        },
        {
          "job_name": "nodejs-security", 
          "tools": ["npm audit", "retire.js", "@cyclonedx/cdxgen"],
          "overlap_with": {},
          "unique_functions": ["Node.js specific scanning", "retire.js"]
        },
        {
          "job_name": "rust-security",
          "tools": ["cargo-audit", "cargo-deny"],
          "overlap_with": {},
          "unique_functions": ["Rust-specific security scanning"]
        },
        {
          "job_name": "go-security", 
          "tools": ["govulncheck", "nancy"],
          "overlap_with": {},
          "unique_functions": ["Go-specific vulnerability scanning"]
        },
        {
          "job_name": "container-security",
          "tools": ["trivy"],
          "overlap_with": {
            "image-security-scan.yml": ["trivy"]
          },
          "unique_functions": ["filesystem scanning context"]
        }
      ],
      "duplicate_ratio": 0.65,
      "consolidation_potential": "HIGH"
    },
    
    "security-compliance.yml": {
      "jobs": [
        {
          "job_name": "security-baseline",
          "tools": ["bandit", "safety", "detect-secrets", "semgrep", "ruff"],
          "overlap_with": {
            "security-scan.yml": ["bandit", "safety", "semgrep"],
            "main-ci.yml": ["bandit", "safety", "semgrep", "detect-secrets"],
            "scion_production.yml": ["bandit", "safety", "detect-secrets"]
          },
          "unique_functions": ["cryptographic validation", "config security validation"]
        },
        {
          "job_name": "sbom-generation",
          "tools": ["cyclonedx-bom", "cyclonedx-npm", "syft", "grype"],
          "overlap_with": {
            "security-scan.yml": ["cyclonedx-bom"],
            "main-ci.yml": ["cyclonedx-bom", "pip-audit SBOM"]
          },
          "unique_functions": ["syft comprehensive SBOM", "grype vulnerability analysis"]
        },
        {
          "job_name": "compliance-validation",
          "tools": ["custom compliance checkers"],
          "overlap_with": {},
          "unique_functions": ["GDPR compliance", "security controls audit", "regulatory validation"]
        }
      ],
      "duplicate_ratio": 0.45,
      "consolidation_potential": "MEDIUM"
    },
    
    "scion_production.yml": {
      "jobs": [
        {
          "job_name": "security-preflight", 
          "tools": ["detect-secrets", "bandit", "safety", "semgrep"],
          "overlap_with": {
            "security-scan.yml": ["bandit", "safety", "semgrep"],
            "security-compliance.yml": ["detect-secrets", "bandit", "safety"],
            "main-ci.yml": ["detect-secrets", "bandit", "safety"]
          },
          "unique_functions": ["production security gate", "emergency bypass validation"]
        },
        {
          "job_name": "scion-prod",
          "tools": ["cargo clippy", "bandit", "safety", "detect-secrets"],
          "overlap_with": {
            "security-scan.yml": ["bandit", "safety"],
            "main-ci.yml": ["bandit", "safety", "detect-secrets"]
          },
          "unique_functions": ["Rust clippy security checks", "production-specific validations"]
        }
      ],
      "duplicate_ratio": 0.80,
      "consolidation_potential": "HIGH"
    },
    
    "image-security-scan.yml": {
      "jobs": [
        {
          "job_name": "scan-images",
          "tools": ["trivy", "docker security checks"],
          "overlap_with": {
            "security-scan.yml": ["trivy"]
          },
          "unique_functions": ["container-specific scanning", "matrix-based multi-image scanning", "security gate integration"]
        },
        {
          "job_name": "security-gate",
          "tools": ["vulnerability analysis", "security gate logic"],
          "overlap_with": {
            "main-ci.yml": ["security gate pattern"],
            "scion_production.yml": ["security gate pattern"]
          },
          "unique_functions": ["container-specific security gates"]
        }
      ],
      "duplicate_ratio": 0.25,
      "consolidation_potential": "LOW"
    },
    
    "main-ci.yml": {
      "jobs": [
        {
          "job_name": "security",
          "tools": ["bandit", "safety", "semgrep", "pip-audit", "detect-secrets"],
          "overlap_with": {
            "security-scan.yml": ["bandit", "safety", "semgrep", "pip-audit"],
            "security-compliance.yml": ["bandit", "safety", "detect-secrets"],
            "scion_production.yml": ["bandit", "safety", "detect-secrets"]
          },
          "unique_functions": ["integration with CI/CD pipeline", "CVE blocking logic"]
        },
        {
          "job_name": "security-gate",
          "tools": ["security validation logic"],
          "overlap_with": {
            "image-security-scan.yml": ["security gate pattern"],
            "scion_production.yml": ["security gate pattern"]
          },
          "unique_functions": ["CI-specific security gates"]
        }
      ],
      "duplicate_ratio": 0.85,
      "consolidation_potential": "CRITICAL"
    }
  },
  
  "cross_workflow_analysis": {
    "total_duplicate_tools": 12,
    "most_duplicated_tools": [
      {"tool": "bandit", "workflows": 5, "duplicate_factor": "CRITICAL"},
      {"tool": "safety", "workflows": 5, "duplicate_factor": "CRITICAL"},
      {"tool": "detect-secrets", "workflows": 3, "duplicate_factor": "HIGH"},
      {"tool": "semgrep", "workflows": 4, "duplicate_factor": "HIGH"},
      {"tool": "trivy", "workflows": 2, "duplicate_factor": "MEDIUM"}
    ],
    
    "functional_overlap_score": 0.68,
    "consolidation_urgency": "HIGH",
    "estimated_redundancy_cost": "35% of total security workflow execution time"
  },
  
  "merger_recommendations": {
    "primary_consolidation": {
      "target_workflow": "security-comprehensive.yml",
      "source_workflows": ["security-scan.yml", "security-compliance.yml"],
      "rationale": "85% tool overlap, complementary SBOM/compliance functions",
      "estimated_savings": "45% execution time reduction"
    },
    
    "secondary_consolidation": {
      "target_workflow": "main-ci.yml (enhanced security job)",
      "source_workflows": ["main-ci.yml security job", "partial scion_production.yml security"],
      "rationale": "Centralize CI security checks, reduce duplication in standard pipeline",
      "estimated_savings": "25% execution time reduction"
    },
    
    "preserve_specialized": {
      "workflows": ["image-security-scan.yml", "scion_production.yml (production gates)"],
      "rationale": "Container scanning and production gates have unique triggers and contexts"
    }
  }
}