<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIVillage Developer Admin Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
        }

        .container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }

        .tab-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #e3f2fd;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .tab-button:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .tab-button.active {
            background: linear-gradient(45deg, #4fc3f7, #29b6f6);
            border-color: #4fc3f7;
            color: #ffffff;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(79, 195, 247, 0.3);
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tab-content.active {
            display: block;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .status-card h3 {
            color: #4fc3f7;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .api-list {
            list-style: none;
            margin-left: 20px;
        }

        .api-list li {
            margin: 8px 0;
            color: #e3f2fd;
            font-family: monospace;
            background: rgba(0, 0, 0, 0.2);
            padding: 8px 12px;
            border-radius: 6px;
        }

        .coming-soon {
            text-align: center;
            padding: 60px 20px;
            color: #e3f2fd;
        }

        .coming-soon h2 {
            color: #4fc3f7;
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .coming-soon p {
            font-size: 1.1rem;
            line-height: 1.6;
            opacity: 0.9;
        }

        .note {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.5);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            color: #fff3cd;
        }

        .note strong {
            color: #ffc107;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
        }

        .metric-label {
            color: #e3f2fd;
            font-size: 0.9rem;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-online { background: #10b981; }
        .status-offline { background: #ef4444; }
        .status-warning { background: #f59e0b; }

        .peer-list {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
        }

        .peer-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .refresh-btn {
            padding: 8px 16px;
            background: rgba(79, 195, 247, 0.2);
            color: #4fc3f7;
            border: 1px solid #4fc3f7;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: rgba(79, 195, 247, 0.3);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4fc3f7, #10b981);
            transition: width 0.3s ease;
        }

        /* Enhanced Fog Computing Styles */
        .component-status {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .component-status:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: #4fc3f7;
            transform: translateY(-2px);
        }

        .component-header {
            font-size: 14px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .component-health {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .component-health.healthy {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .component-health.degraded {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }

        .component-health.critical {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .component-health.offline {
            background: rgba(107, 114, 128, 0.2);
            color: #6b7280;
            border: 1px solid rgba(107, 114, 128, 0.3);
        }

        .component-metric {
            font-size: 11px;
            color: #a0aec0;
            font-family: monospace;
        }

        .fog-test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 13px;
        }

        .fog-test-success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981;
        }

        .fog-test-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        .fog-test-warning {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            color: #fbbf24;
        }

        @media (max-width: 768px) {
            .tabs {
                flex-wrap: wrap;
                gap: 8px;
            }

            .tab-button {
                font-size: 14px;
                padding: 10px 16px;
            }

            .metrics-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ AIVillage Developer Admin</h1>
            <p>Backend Development Interface</p>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="showTab('system')">System Monitor</button>
            <button class="tab-button" onclick="showTab('agent-forge')">Agent Forge</button>
            <button class="tab-button" onclick="showTab('p2p-network')">P2P Network</button>
            <button class="tab-button" onclick="showTab('fog-computing')">Fog Computing</button>
            <button class="tab-button" onclick="showTab('security-privacy')">Security & Privacy</button>
        </div>

        <div id="system" class="tab-content active">
            <div class="status-card">
                <h3>üñ•Ô∏è System Status</h3>
                <p>Backend API server is running on <strong>localhost:8080</strong></p>
                <p>Development mode enabled</p>
            </div>

            <div class="status-card">
                <h3>üì° Available API Endpoints</h3>
                <ul class="api-list">
                    <li>GET /healthz - Health check</li>
                    <li>POST /query - RAG query processing</li>
                    <li>POST /upload - File upload</li>
                    <li>GET /bayes - Bayesian network snapshot</li>
                    <li>GET /logs - System logs</li>
                </ul>
            </div>

            <div class="note">
                <strong>Note:</strong> This is the simplified admin interface. The full React frontend is available but needs TypeScript compilation fixes.
            </div>
        </div>

        <div id="agent-forge" class="tab-content">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2>ü§ñ Agent Forge Complete Pipeline</h2>
                <p>8-Phase ML System with REAL TRAINING: Cognate (3x25M ACT+LTM) ‚Üí EvoMerge ‚Üí Quiet-STaR ‚Üí BitNet ‚Üí Training ‚Üí Tools ‚Üí ADAS ‚Üí Compression</p>
            </div>

            <!-- Pipeline Overview -->
            <div class="status-card">
                <h3>üöÄ Pipeline Overview & Controls</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="pipeline-phases-completed">0/8</div>
                        <div class="metric-label">Phases Completed</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="pipeline-models-created">0</div>
                        <div class="metric-label">Models Created</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="pipeline-status">Ready</div>
                        <div class="metric-label">Pipeline Status</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="pipeline-real-training" style="color: #4fc3f7;">‚úÖ INTEGRATED</div>
                        <div class="metric-label">Real Training</div>
                    </div>
                </div>
                <div style="text-align: center; margin: 20px 0;">
                    <button onclick="runCompletePipeline()" style="padding: 15px 30px; background: linear-gradient(45deg, #4fc3f7, #29b6f6); color: #ffffff; border: none; border-radius: 8px; cursor: pointer; margin: 5px; font-weight: 600; font-size: 18px; box-shadow: 0 4px 15px rgba(79, 195, 247, 0.3);">
                        üöÄ RUN COMPLETE PIPELINE
                    </button>
                    <button onclick="checkAllPhases()" style="padding: 15px 30px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; cursor: pointer; margin: 5px; font-weight: 600;">
                        üìä CHECK ALL STATUS
                    </button>
                    <button onclick="resetPipeline()" style="padding: 15px 30px; background: rgba(239, 68, 68, 0.2); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; cursor: pointer; margin: 5px; font-weight: 600;">
                        üîÑ RESET PIPELINE
                    </button>
                </div>
            </div>

            <!-- 8-Phase Control Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin: 20px 0;">
                
                <!-- Phase 1: Cognate -->
                <div class="status-card phase-card" id="phase-cognate">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h4 style="color: #4fc3f7; margin: 0;">üß† Phase 1: Cognate</h4>
                        <span class="phase-status" id="cognate-status" style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: rgba(107, 114, 128, 0.2); color: #6b7280;">Ready</span>
                    </div>
                    <div class="progress-bar" style="height: 8px; background: #374151; border-radius: 4px; margin: 10px 0;">
                        <div class="progress-fill" id="cognate-progress" style="height: 100%; width: 0%; background: linear-gradient(90deg, #4fc3f7, #10b981); transition: width 0.3s ease; border-radius: 4px;"></div>
                    </div>
                    <div id="cognate-message" style="color: #e3f2fd; font-size: 14px; margin: 10px 0;">REAL TRAINING: 3x 25M ACT+LTM models (8,173+ samples: GSM8K, SVAMP, Mini-MBPP)</div>
                    <div style="color: #fbbf24; font-size: 12px; font-weight: 600;">‚è±Ô∏è Est. Duration: 6+ hours</div>
                    <div style="display: flex; gap: 5px; margin-top: 15px;">
                        <button onclick="startPhase('cognate')" style="flex: 1; padding: 8px 12px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Start</button>
                        <button onclick="configurePhase('cognate')" style="padding: 8px 12px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">‚öôÔ∏è</button>
                    </div>
                    <div class="phase-features" style="margin-top: 10px; font-size: 12px; color: #a0aec0;">
                        ‚Ä¢ GSM8K, HotpotQA, SVAMP datasets<br>
                        ‚Ä¢ GrokFast 50x acceleration<br>
                        ‚Ä¢ ACT adaptive computation
                    </div>
                </div>

                <!-- Phase 2: EvoMerge -->
                <div class="status-card phase-card" id="phase-evomerge">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h4 style="color: #4fc3f7; margin: 0;">üß¨ Phase 2: EvoMerge</h4>
                        <span class="phase-status" id="evomerge-status" style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: rgba(107, 114, 128, 0.2); color: #6b7280;">Pending</span>
                    </div>
                    <div class="progress-bar" style="height: 8px; background: #374151; border-radius: 4px; margin: 10px 0;">
                        <div class="progress-fill" id="evomerge-progress" style="height: 100%; width: 0%; background: linear-gradient(90deg, #4fc3f7, #10b981); transition: width 0.3s ease; border-radius: 4px;"></div>
                    </div>
                    <div id="evomerge-message" style="color: #e3f2fd; font-size: 14px; margin: 10px 0;">REAL EVOLUTION: 50 generations √ó 8 models = 400 evaluations with benchmarking</div>
                    <div style="color: #fbbf24; font-size: 12px; font-weight: 600;">‚è±Ô∏è REAL Duration: 6-12 hours (400 model evaluations)</div>
                    <div style="display: flex; gap: 5px; margin-top: 15px;">
                        <button onclick="startPhase('evomerge')" style="flex: 1; padding: 8px 12px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Start</button>
                        <button onclick="configurePhase('evomerge')" style="padding: 8px 12px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">‚öôÔ∏è</button>
                    </div>
                    <div class="phase-features" style="margin-top: 10px; font-size: 12px; color: #a0aec0;">
                        ‚Ä¢ 6 merge techniques (TIES, DARE, etc.)<br>
                        ‚Ä¢ Population size: 8 candidates<br>
                        ‚Ä¢ Multi-objective optimization
                    </div>
                </div>

                <!-- Phase 3: Quiet-STaR -->
                <div class="status-card phase-card" id="phase-quietstar">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h4 style="color: #4fc3f7; margin: 0;">ü§î Phase 3: Quiet-STaR</h4>
                        <span class="phase-status" id="quietstar-status" style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: rgba(107, 114, 128, 0.2); color: #6b7280;">Pending</span>
                    </div>
                    <div class="progress-bar" style="height: 8px; background: #374151; border-radius: 4px; margin: 10px 0;">
                        <div class="progress-fill" id="quietstar-progress" style="height: 100%; width: 0%; background: linear-gradient(90deg, #4fc3f7, #10b981); transition: width 0.3s ease; border-radius: 4px;"></div>
                    </div>
                    <div id="quietstar-message" style="color: #e3f2fd; font-size: 14px; margin: 10px 0;">Reasoning enhancement through thought baking</div>
                    <div style="display: flex; gap: 5px; margin-top: 15px;">
                        <button onclick="startPhase('quietstar')" style="flex: 1; padding: 8px 12px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Start</button>
                        <button onclick="configurePhase('quietstar')" style="padding: 8px 12px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">‚öôÔ∏è</button>
                    </div>
                    <div class="phase-features" style="margin-top: 10px; font-size: 12px; color: #a0aec0;">
                        ‚Ä¢ 32-token thought sequences<br>
                        ‚Ä¢ 4 parallel thoughts per input<br>
                        ‚Ä¢ Silent reasoning development
                    </div>
                </div>

                <!-- Phase 4: BitNet -->
                <div class="status-card phase-card" id="phase-bitnet">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h4 style="color: #4fc3f7; margin: 0;">üî¢ Phase 4: BitNet 1.58</h4>
                        <span class="phase-status" id="bitnet-status" style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: rgba(107, 114, 128, 0.2); color: #6b7280;">Pending</span>
                    </div>
                    <div class="progress-bar" style="height: 8px; background: #374151; border-radius: 4px; margin: 10px 0;">
                        <div class="progress-fill" id="bitnet-progress" style="height: 100%; width: 0%; background: linear-gradient(90deg, #4fc3f7, #10b981); transition: width 0.3s ease; border-radius: 4px;"></div>
                    </div>
                    <div id="bitnet-message" style="color: #e3f2fd; font-size: 14px; margin: 10px 0;">1.58-bit ternary quantization {-1, 0, +1}</div>
                    <div style="display: flex; gap: 5px; margin-top: 15px;">
                        <button onclick="startPhase('bitnet')" style="flex: 1; padding: 8px 12px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Start</button>
                        <button onclick="configurePhase('bitnet')" style="padding: 8px 12px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">‚öôÔ∏è</button>
                    </div>
                    <div class="phase-features" style="margin-top: 10px; font-size: 12px; color: #a0aec0;">
                        ‚Ä¢ 8x memory compression<br>
                        ‚Ä¢ Group-wise quantization (128 groups)<br>
                        ‚Ä¢ Fine-tuning recovery
                    </div>
                </div>

                <!-- Phase 5: Forge Training -->
                <div class="status-card phase-card" id="phase-forge-training">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h4 style="color: #4fc3f7; margin: 0;">üî• Phase 5: Forge Training</h4>
                        <span class="phase-status" id="forge-training-status" style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: rgba(107, 114, 128, 0.2); color: #6b7280;">Pending</span>
                    </div>
                    <div class="progress-bar" style="height: 8px; background: #374151; border-radius: 4px; margin: 10px 0;">
                        <div class="progress-fill" id="forge-training-progress" style="height: 100%; width: 0%; background: linear-gradient(90deg, #4fc3f7, #10b981); transition: width 0.3s ease; border-radius: 4px;"></div>
                    </div>
                    <div id="forge-training-message" style="color: #e3f2fd; font-size: 14px; margin: 10px 0;">10-level Grokfast + edge-of-chaos + dreaming</div>
                    <div style="display: flex; gap: 5px; margin-top: 15px;">
                        <button onclick="startPhase('forge-training')" style="flex: 1; padding: 8px 12px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Start</button>
                        <button onclick="configurePhase('forge-training')" style="padding: 8px 12px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">‚öôÔ∏è</button>
                    </div>
                    <div class="phase-features" style="margin-top: 10px; font-size: 12px; color: #a0aec0;">
                        ‚Ä¢ Edge control (55-75% success)<br>
                        ‚Ä¢ Dream cycles every 1000 steps<br>
                        ‚Ä¢ Self-modeling TAP layers
                    </div>
                </div>

                <!-- Phase 6: Tool/Persona -->
                <div class="status-card phase-card" id="phase-tool-persona">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h4 style="color: #4fc3f7; margin: 0;">üõ†Ô∏è Phase 6: Tool/Persona</h4>
                        <span class="phase-status" id="tool-persona-status" style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: rgba(107, 114, 128, 0.2); color: #6b7280;">Pending</span>
                    </div>
                    <div class="progress-bar" style="height: 8px; background: #374151; border-radius: 4px; margin: 10px 0;">
                        <div class="progress-fill" id="tool-persona-progress" style="height: 100%; width: 0%; background: linear-gradient(90deg, #4fc3f7, #10b981); transition: width 0.3s ease; border-radius: 4px;"></div>
                    </div>
                    <div id="tool-persona-message" style="color: #e3f2fd; font-size: 14px; margin: 10px 0;">DSPy iterative tool use + persona optimization</div>
                    <div style="display: flex; gap: 5px; margin-top: 15px;">
                        <button onclick="startPhase('tool-persona')" style="flex: 1; padding: 8px 12px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Start</button>
                        <button onclick="configurePhase('tool-persona')" style="padding: 8px 12px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">‚öôÔ∏è</button>
                    </div>
                    <div class="phase-features" style="margin-top: 10px; font-size: 12px; color: #a0aec0;">
                        ‚Ä¢ RAG, code exec, web search<br>
                        ‚Ä¢ Persona traits optimization<br>
                        ‚Ä¢ Half-baked tool use patterns
                    </div>
                </div>

                <!-- Phase 7: ADAS -->
                <div class="status-card phase-card" id="phase-adas">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h4 style="color: #4fc3f7; margin: 0;">üèóÔ∏è Phase 7: ADAS</h4>
                        <span class="phase-status" id="adas-status" style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: rgba(107, 114, 128, 0.2); color: #6b7280;">Pending</span>
                    </div>
                    <div class="progress-bar" style="height: 8px; background: #374151; border-radius: 4px; margin: 10px 0;">
                        <div class="progress-fill" id="adas-progress" style="height: 100%; width: 0%; background: linear-gradient(90deg, #4fc3f7, #10b981); transition: width 0.3s ease; border-radius: 4px;"></div>
                    </div>
                    <div id="adas-message" style="color: #e3f2fd; font-size: 14px; margin: 10px 0;">Transformer¬≤ architecture search</div>
                    <div style="display: flex; gap: 5px; margin-top: 15px;">
                        <button onclick="startPhase('adas')" style="flex: 1; padding: 8px 12px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Start</button>
                        <button onclick="configurePhase('adas')" style="padding: 8px 12px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">‚öôÔ∏è</button>
                    </div>
                    <div class="phase-features" style="margin-top: 10px; font-size: 12px; color: #a0aec0;">
                        ‚Ä¢ NSGA-II optimization<br>
                        ‚Ä¢ Vector composition operators<br>
                        ‚Ä¢ 20 architectures, 10 generations
                    </div>
                </div>

                <!-- Phase 8: Final Compression -->
                <div class="status-card phase-card" id="phase-final-compression">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <h4 style="color: #4fc3f7; margin: 0;">üóúÔ∏è Phase 8: Final Compression</h4>
                        <span class="phase-status" id="final-compression-status" style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: rgba(107, 114, 128, 0.2); color: #6b7280;">Pending</span>
                    </div>
                    <div class="progress-bar" style="height: 8px; background: #374151; border-radius: 4px; margin: 10px 0;">
                        <div class="progress-fill" id="final-compression-progress" style="height: 100%; width: 0%; background: linear-gradient(90deg, #4fc3f7, #10b981); transition: width 0.3s ease; border-radius: 4px;"></div>
                    </div>
                    <div id="final-compression-message" style="color: #e3f2fd; font-size: 14px; margin: 10px 0;">SeedLM + VPTQ + HyperCompression stack</div>
                    <div style="display: flex; gap: 5px; margin-top: 15px;">
                        <button onclick="startPhase('final-compression')" style="flex: 1; padding: 8px 12px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Start</button>
                        <button onclick="configurePhase('final-compression')" style="padding: 8px 12px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">‚öôÔ∏è</button>
                    </div>
                    <div class="phase-features" style="margin-top: 10px; font-size: 12px; color: #a0aec0;">
                        ‚Ä¢ 3-part compression stack<br>
                        ‚Ä¢ 5% seed ratio, 256 codebook<br>
                        ‚Ä¢ Production deployment ready
                    </div>
                </div>
            </div>

            <!-- Model Library -->
            <div class="status-card">
                <h3>üìö Enhanced Model Library</h3>
                <div id="model-library">
                    <p style="color: #a0aec0; font-style: italic;">No models created yet. Start phases to create specialized models across the pipeline.</p>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button onclick="loadModelLibrary()" style="padding: 10px 20px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer;">
                        üîÑ Refresh Models
                    </button>
                    <button onclick="exportModels()" style="padding: 10px 20px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; margin-left: 10px;">
                        üì§ Export Models
                    </button>
                </div>
            </div>

            <!-- Chat Interface -->
            <div class="status-card">
                <h3>üí¨ Multi-Model Chat Interface</h3>
                <div id="chat-interface" style="margin: 20px 0;">
                    <select id="model-selector" style="width: 100%; padding: 10px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; margin-bottom: 15px;">
                        <option>Select a model to chat with...</option>
                    </select>
                    <div style="display: flex; gap: 10px;">
                        <input id="chat-input" type="text" placeholder="Ask your specialized model a question..."
                               style="flex: 1; padding: 10px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px;">
                        <button onclick="sendChatMessage()" style="padding: 10px 20px; background: #4fc3f7; color: #1a1a1a; border: none; border-radius: 6px; cursor: pointer;">
                            Send
                        </button>
                    </div>
                    <div id="chat-messages" style="margin-top: 20px; max-height: 300px; overflow-y: auto; background: rgba(0, 0, 0, 0.2); border-radius: 6px; padding: 15px;">
                        <p style="color: #a0aec0; font-style: italic;">Chat with your specialized models here. Different phases create models with unique capabilities.</p>
                    </div>
                </div>
            </div>

            <!-- Real-time Activity Log -->
            <div class="status-card">
                <h3>üì° Real-time Pipeline Activity</h3>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <div id="connection-status" style="padding: 8px 15px; border-radius: 6px; font-size: 14px; background: rgba(239, 68, 68, 0.2); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.3);">
                        üî¥ WebSocket: Disconnected
                    </div>
                    <button onclick="clearLog()" style="padding: 8px 15px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">
                        Clear Log
                    </button>
                    <button onclick="exportLog()" style="padding: 8px 15px; background: rgba(255, 255, 255, 0.1); color: #e3f2fd; border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; cursor: pointer; font-size: 14px;">
                        üì§ Export Log
                    </button>
                </div>
                <div id="message-log" style="background: rgba(0, 0, 0, 0.3); border-radius: 6px; padding: 15px; max-height: 250px; overflow-y: auto; font-family: monospace; font-size: 14px;">
                    <div style="color: #a0aec0;">[Ready] Agent Forge 8-Phase Pipeline Control Panel initialized</div>
                    <div style="color: #4fc3f7;">[Info] All 8 phases ready for execution</div>
                    <div style="color: #10b981;">[System] WebSocket connecting for real-time updates...</div>
                </div>
            </div>
        </div>

        <!-- P2P Network Tab -->
        <div id="p2p-network" class="tab-content">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2>üåê P2P Network Control Panel</h2>
                <p>BitChat Mesh & BetaNet Circuit Management</p>
            </div>

            <!-- Connection Status -->
            <div class="status-card">
                <h3>üîó Network Status</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="p2p-connected-peers">0</div>
                        <div class="metric-label">Connected Peers</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="p2p-network-health">Unknown</div>
                        <div class="metric-label">Network Health</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="p2p-bitchat-status">Offline</div>
                        <div class="metric-label">BitChat Status</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="p2p-betanet-circuits">0</div>
                        <div class="metric-label">BetaNet Circuits</div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button class="refresh-btn" onclick="refreshP2PStatus()">üîÑ Refresh Status</button>
                </div>
            </div>

            <!-- Peer List -->
            <div class="status-card">
                <h3>üë• Connected Peers</h3>
                <div id="peer-list" class="peer-list">
                    <div style="color: #a0aec0; font-style: italic; text-align: center; padding: 20px;">
                        No peers connected. Click refresh to update.
                    </div>
                </div>
            </div>

            <!-- Message Activity -->
            <div class="status-card">
                <h3>üì® Message Activity</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="p2p-messages-sent">0</div>
                        <div class="metric-label">Messages Sent</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="p2p-messages-received">0</div>
                        <div class="metric-label">Messages Received</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="p2p-routing-efficiency">0%</div>
                        <div class="metric-label">Routing Efficiency</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="p2p-bandwidth-usage">0 MB</div>
                        <div class="metric-label">Bandwidth Used</div>
                    </div>
                </div>
            </div>

            <!-- Network Topology -->
            <div class="status-card">
                <h3>üï∏Ô∏è Network Topology</h3>
                <div id="p2p-topology-info" style="background: rgba(0, 0, 0, 0.2); border-radius: 6px; padding: 15px; font-family: monospace; font-size: 14px;">
                    <div style="color: #a0aec0;">Network topology information will appear here...</div>
                </div>
            </div>
        </div>

        <!-- Fog Computing Tab -->
        <div id="fog-computing" class="tab-content">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2>‚òÅÔ∏è Enhanced Fog Computing Control Panel</h2>
                <p>Complete 8-Component Fog System Integration</p>
            </div>

            <!-- System Overview -->
            <div class="status-card">
                <h3>üåê System Overview</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="fog-system-health">Unknown</div>
                        <div class="metric-label">System Health</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="fog-healthy-components">0/8</div>
                        <div class="metric-label">Healthy Components</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="fog-total-operations">0</div>
                        <div class="metric-label">Total Operations</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="fog-success-rate">0%</div>
                        <div class="metric-label">Success Rate</div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button class="refresh-btn" onclick="refreshFogSystemStatus()">üîÑ Refresh System</button>
                    <button class="refresh-btn" onclick="restartFogSystem()">üîÑ Restart System</button>
                </div>
            </div>

            <!-- Component Status Grid -->
            <div class="status-card">
                <h3>üîß Component Status Matrix</h3>
                <div class="component-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin: 15px 0;">
                    <div class="component-status" id="tee-runtime-status">
                        <div class="component-header" style="color: #4fc3f7; font-weight: bold;">üîê TEE Runtime</div>
                        <div class="component-health" id="tee-health">Offline</div>
                        <div class="component-metric" id="tee-enclaves">0 enclaves</div>
                    </div>
                    <div class="component-status" id="proof-system-status">
                        <div class="component-header" style="color: #4fc3f7; font-weight: bold;">üîí Proof System</div>
                        <div class="component-health" id="proof-health">Offline</div>
                        <div class="component-metric" id="proof-count">0 proofs</div>
                    </div>
                    <div class="component-status" id="pricing-manager-status">
                        <div class="component-header" style="color: #4fc3f7; font-weight: bold;">üí∞ Dynamic Pricing</div>
                        <div class="component-health" id="pricing-health">Offline</div>
                        <div class="component-metric" id="pricing-volatility">0% volatility</div>
                    </div>
                    <div class="component-status" id="scheduler-status">
                        <div class="component-header" style="color: #4fc3f7; font-weight: bold;">üìã Job Scheduler</div>
                        <div class="component-health" id="scheduler-health">Offline</div>
                        <div class="component-metric" id="scheduled-jobs">0 jobs</div>
                    </div>
                    <div class="component-status" id="quorum-manager-status">
                        <div class="component-header" style="color: #4fc3f7; font-weight: bold;">üó≥Ô∏è Byzantine Quorum</div>
                        <div class="component-health" id="quorum-health">Offline</div>
                        <div class="component-metric" id="consensus-rounds">0 rounds</div>
                    </div>
                    <div class="component-status" id="onion-router-status">
                        <div class="component-header" style="color: #4fc3f7; font-weight: bold;">üßÖ Onion Routing</div>
                        <div class="component-health" id="onion-health">Offline</div>
                        <div class="component-metric" id="onion-circuits">0 circuits</div>
                    </div>
                    <div class="component-status" id="reputation-system-status">
                        <div class="component-header" style="color: #4fc3f7; font-weight: bold;">‚≠ê Reputation System</div>
                        <div class="component-health" id="reputation-health">Offline</div>
                        <div class="component-metric" id="reputation-updates">0 updates</div>
                    </div>
                    <div class="component-status" id="vrf-selector-status">
                        <div class="component-header" style="color: #4fc3f7; font-weight: bold;">üéØ VRF Neighbor</div>
                        <div class="component-health" id="vrf-health">Offline</div>
                        <div class="component-metric" id="vrf-selections">0 selections</div>
                    </div>
                </div>
            </div>

            <!-- TEE Runtime Management -->
            <div class="status-card">
                <h3>üîê TEE Runtime Management</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="tee-active-enclaves">0</div>
                        <div class="metric-label">Active Enclaves</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="tee-memory-usage">0 MB</div>
                        <div class="metric-label">TEE Memory</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="tee-attestations">0</div>
                        <div class="metric-label">Attestations</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="tee-security-level">Unknown</div>
                        <div class="metric-label">Security Level</div>
                    </div>
                </div>
                <div style="margin: 15px 0;">
                    <button class="refresh-btn" onclick="createTEEEnclave()">üîê Create Enclave</button>
                    <button class="refresh-btn" onclick="testTEEAttestation()">üõ°Ô∏è Test Attestation</button>
                </div>
            </div>

            <!-- Cryptographic Proof System -->
            <div class="status-card">
                <h3>üîí Cryptographic Proof System</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="proof-generated">0</div>
                        <div class="metric-label">Proofs Generated</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="proof-verified">0</div>
                        <div class="metric-label">Proofs Verified</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="zk-predicates">0</div>
                        <div class="metric-label">ZK Predicates</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="proof-success-rate">0%</div>
                        <div class="metric-label">Proof Success Rate</div>
                    </div>
                </div>
                <div style="margin: 15px 0;">
                    <button class="refresh-btn" onclick="generateTestProof()">üîç Generate Test Proof</button>
                    <button class="refresh-btn" onclick="testZKPredicate()">ü§ê Test ZK Predicate</button>
                </div>
            </div>

            <!-- Dynamic Pricing & Market -->
            <div class="status-card">
                <h3>üí∞ Market-based Dynamic Pricing</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="market-condition">Normal</div>
                        <div class="metric-label">Market Condition</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="avg-cpu-price">$0.00</div>
                        <div class="metric-label">Avg CPU Price/hr</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="pricing-alerts">0</div>
                        <div class="metric-label">Pricing Alerts</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="market-health">Unknown</div>
                        <div class="metric-label">Market Health</div>
                    </div>
                </div>
                <div style="margin: 15px 0;">
                    <button class="refresh-btn" onclick="getPricingQuote()">üí≤ Get Pricing Quote</button>
                    <button class="refresh-btn" onclick="viewMarketAnalytics()">üìà Market Analytics</button>
                </div>
            </div>

            <!-- Job Scheduling & Placement -->
            <div class="status-card">
                <h3>üìã NSGA-II Job Scheduler</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="total-jobs-scheduled">0</div>
                        <div class="metric-label">Jobs Scheduled</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="scheduler-success-rate">0%</div>
                        <div class="metric-label">Success Rate</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="avg-placement-latency">0ms</div>
                        <div class="metric-label">Avg Latency</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="pareto-solutions">0</div>
                        <div class="metric-label">Pareto Solutions</div>
                    </div>
                </div>
                <div style="margin: 15px 0;">
                    <button class="refresh-btn" onclick="scheduleTestJob()">üìã Schedule Test Job</button>
                    <button class="refresh-btn" onclick="viewSchedulerStats()">üìä Scheduler Stats</button>
                </div>
            </div>

            <!-- Byzantine Quorum & Consensus -->
            <div class="status-card">
                <h3>üó≥Ô∏è Byzantine Quorum System</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="quorum-nodes">0</div>
                        <div class="metric-label">Quorum Nodes</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="consensus-success-rate">0%</div>
                        <div class="metric-label">Consensus Success</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="byzantine-tolerance">0</div>
                        <div class="metric-label">Byzantine Tolerance</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="avg-consensus-time">0ms</div>
                        <div class="metric-label">Avg Consensus Time</div>
                    </div>
                </div>
                <div style="margin: 15px 0;">
                    <button class="refresh-btn" onclick="initiateConsensus()">üó≥Ô∏è Test Consensus</button>
                    <button class="refresh-btn" onclick="viewQuorumStatus()">üìä Quorum Status</button>
                </div>
            </div>

            <!-- System Testing Interface -->
            <div class="status-card">
                <h3>üß™ System Testing Interface</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 15px 0;">
                    <div style="background: rgba(0, 0, 0, 0.2); border-radius: 6px; padding: 15px;">
                        <h4 style="color: #4fc3f7; margin-bottom: 10px;">Integration Tests</h4>
                        <button class="refresh-btn" onclick="runFullSystemTest()" style="width: 100%; margin: 5px 0;">üîÑ Full System Test</button>
                        <button class="refresh-btn" onclick="runComponentTest()" style="width: 100%; margin: 5px 0;">üîß Component Test</button>
                        <button class="refresh-btn" onclick="runPerformanceTest()" style="width: 100%; margin: 5px 0;">‚ö° Performance Test</button>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.2); border-radius: 6px; padding: 15px;">
                        <h4 style="color: #4fc3f7; margin-bottom: 10px;">Load Testing</h4>
                        <button class="refresh-btn" onclick="runLoadTest('light')" style="width: 100%; margin: 5px 0;">üî• Light Load Test</button>
                        <button class="refresh-btn" onclick="runLoadTest('heavy')" style="width: 100%; margin: 5px 0;">üöÄ Heavy Load Test</button>
                        <button class="refresh-btn" onclick="runStressTest()" style="width: 100%; margin: 5px 0;">üí• Stress Test</button>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.2); border-radius: 6px; padding: 15px;">
                        <h4 style="color: #4fc3f7; margin-bottom: 10px;">Recovery Tests</h4>
                        <button class="refresh-btn" onclick="testFailureRecovery()" style="width: 100%; margin: 5px 0;">üîß Failure Recovery</button>
                        <button class="refresh-btn" onclick="testComponentRestart()" style="width: 100%; margin: 5px 0;">üîÑ Component Restart</button>
                        <button class="refresh-btn" onclick="testSystemResilience()" style="width: 100%; margin: 5px 0;">üõ°Ô∏è System Resilience</button>
                    </div>
                </div>
            </div>

            <!-- Real-time System Monitor -->
            <div class="status-card">
                <h3>üìä Real-time System Monitor</h3>
                <div id="fog-system-monitor" style="background: rgba(0, 0, 0, 0.3); border-radius: 6px; padding: 15px; max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 14px;">
                    <div style="color: #a0aec0;">[System] Enhanced Fog Computing System initialized</div>
                    <div style="color: #4fc3f7;">[Info] 8 components ready for integration</div>
                    <div style="color: #10b981;">[Ready] System monitoring active</div>
                </div>
                <div style="text-align: center; margin-top: 10px;">
                    <button class="refresh-btn" onclick="clearSystemMonitor()">üóëÔ∏è Clear Monitor</button>
                    <button class="refresh-btn" onclick="exportSystemLogs()">üíæ Export Logs</button>
                </div>
            </div>
        </div>

        <!-- Security & Privacy Tab -->
        <div id="security-privacy" class="tab-content">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2>üîí Security & Privacy Control Panel</h2>
                <p>Onion Routing & Anonymity Protection</p>
            </div>

            <!-- Anonymity Status -->
            <div class="status-card">
                <h3>üßÖ Onion Routing Status</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="security-onion-status">
                            <span class="status-indicator status-offline"></span>Offline
                        </div>
                        <div class="metric-label">Onion Router</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-circuit-count">0</div>
                        <div class="metric-label">Active Circuits</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-relay-nodes">0</div>
                        <div class="metric-label">Relay Nodes</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-exit-nodes">0</div>
                        <div class="metric-label">Exit Nodes</div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button class="refresh-btn" onclick="refreshSecurityStatus()">üîÑ Refresh Status</button>
                    <button class="refresh-btn" onclick="toggleOnionRouting()" id="toggle-onion-btn">üßÖ Enable Onion Routing</button>
                </div>
            </div>

            <!-- Privacy Metrics -->
            <div class="status-card">
                <h3>üõ°Ô∏è Privacy Indicators</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="security-anonymity-level">Unknown</div>
                        <div class="metric-label">Anonymity Level</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-traffic-obfuscation">0%</div>
                        <div class="metric-label">Traffic Obfuscation</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-metadata-protection">Unknown</div>
                        <div class="metric-label">Metadata Protection</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-ip-leakage">Unknown</div>
                        <div class="metric-label">IP Leakage Status</div>
                    </div>
                </div>
            </div>

            <!-- Network Security -->
            <div class="status-card">
                <h3>üîê Network Security</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4 style="color: #4fc3f7; margin-bottom: 10px;">Encryption Status</h4>
                        <div style="background: rgba(0, 0, 0, 0.2); border-radius: 6px; padding: 10px;">
                            <div style="margin: 5px 0; color: #e3f2fd;">
                                <span class="status-indicator status-online"></span>End-to-End Encryption: Active
                            </div>
                            <div style="margin: 5px 0; color: #e3f2fd;">
                                <span class="status-indicator status-online"></span>Transport Layer Security: Active
                            </div>
                            <div style="margin: 5px 0; color: #e3f2fd;">
                                <span class="status-indicator status-warning"></span>Perfect Forward Secrecy: Partial
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4 style="color: #4fc3f7; margin-bottom: 10px;">Security Protocols</h4>
                        <div style="background: rgba(0, 0, 0, 0.2); border-radius: 6px; padding: 10px;">
                            <div style="margin: 5px 0; color: #e3f2fd;">
                                <span class="status-indicator status-online"></span>Zero-Knowledge Proofs: Active
                            </div>
                            <div style="margin: 5px 0; color: #e3f2fd;">
                                <span class="status-indicator status-offline"></span>Mixnet Protocol: Inactive
                            </div>
                            <div style="margin: 5px 0; color: #e3f2fd;">
                                <span class="status-indicator status-online"></span>Steganography: Active
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Threat Detection -->
            <div class="status-card">
                <h3>‚ö†Ô∏è Threat Detection</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="security-threats-detected">0</div>
                        <div class="metric-label">Threats Detected</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-attacks-blocked">0</div>
                        <div class="metric-label">Attacks Blocked</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-intrusions">0</div>
                        <div class="metric-label">Intrusion Attempts</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="security-risk-level">Low</div>
                        <div class="metric-label">Current Risk Level</div>
                    </div>
                </div>
            </div>

            <!-- Security Log -->
            <div class="status-card">
                <h3>üìã Security Event Log</h3>
                <div id="security-log" style="background: rgba(0, 0, 0, 0.3); border-radius: 6px; padding: 15px; max-height: 200px; overflow-y: auto; font-family: monospace; font-size: 14px;">
                    <div style="color: #a0aec0;">[System] Security monitoring initialized</div>
                    <div style="color: #10b981;">[Info] All security protocols operational</div>
                    <div style="color: #4fc3f7;">[Event] Privacy protection services active</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');

            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Auto-refresh system info
        setInterval(() => {
            fetch('/healthz')
                .then(r => r.json())
                .then(data => {
                    console.log('System health:', data);
                })
                .catch(e => console.log('Health check failed:', e));
        }, 5000);

        // Agent Forge Functions
        let ws = null;
        let models = [];

        function initializeWebSocket() {
            try {
                ws = new WebSocket('ws://localhost:8083/ws');

                ws.onopen = function() {
                    updateConnectionStatus('üü¢ WebSocket: Connected', '#10b981');
                    addLogMessage('üîó Connected to WebSocket server', 'success');

                    // Subscribe to channels
                    ws.send(JSON.stringify({ type: 'subscribe', channel: 'agent_forge_phases' }));
                    ws.send(JSON.stringify({ type: 'subscribe', channel: 'model_updates' }));
                };

                ws.onmessage = function(event) {
                    const data = JSON.parse(event.data);
                    handleWebSocketMessage(data);
                };

                ws.onclose = function() {
                    updateConnectionStatus('üî¥ WebSocket: Disconnected', '#ef4444');
                    addLogMessage('‚ö†Ô∏è WebSocket connection lost', 'warning');
                };

                ws.onerror = function(error) {
                    addLogMessage('‚ùå WebSocket error: ' + error, 'error');
                };
            } catch (error) {
                addLogMessage('‚ùå Failed to connect to WebSocket', 'error');
            }
        }

        function handleWebSocketMessage(data) {
            switch (data.type) {
                case 'phase_update':
                    // Update specific phase progress
                    const phaseMap = {
                        'Cognate': 'cognate',
                        'EvoMerge': 'evomerge',
                        'Quiet-STaR': 'quietstar',
                        'BitNet': 'bitnet',
                        'Forge Training': 'forge-training',
                        'Tool/Persona': 'tool-persona',
                        'ADAS': 'adas',
                        'Final Compression': 'final-compression'
                    };
                    
                    const phaseId = phaseMap[data.phase_name];
                    if (phaseId) {
                        const status = data.status || (data.progress >= 1.0 ? 'completed' : 'running');
                        updatePhaseStatus(phaseId, status, data.progress || 0);
                    }
                    
                    // Also update Cognate specific UI if it's Cognate phase
                    if (data.phase_name === 'Cognate') {
                        updateCognateProgress(data.progress, data.message, data.status);
                    }
                    
                    addLogMessage(`üìä ${data.phase_name}: ${Math.round((data.progress || 0) * 100)}% - ${data.message}`, 'info');
                    break;

                case 'pipeline_update':
                    // Update pipeline overview
                    if (data.pipeline_progress !== undefined) {
                        const pipelineProgressPercent = Math.round(data.pipeline_progress * 100);
                        addLogMessage(`üöÄ Pipeline: ${pipelineProgressPercent}% - ${data.message}`, 'info');
                    }
                    break;

                case 'pipeline_complete':
                    addLogMessage(`üéâ ${data.message}`, 'success');
                    document.getElementById('pipeline-status').textContent = 'Completed';
                    document.getElementById('pipeline-status').style.color = '#10b981';
                    break;

                case 'model_update':
                    handleModelUpdate(data);
                    break;

                default:
                    addLogMessage(`üì® ${data.type}: ${JSON.stringify(data)}`, 'info');
            }
        }

        function updateConnectionStatus(text, color) {
            const status = document.getElementById('connection-status');
            status.textContent = text;
            status.style.background = `${color}33`;
            status.style.borderColor = `${color}66`;
        }

        function addLogMessage(message, type = 'info') {
            const log = document.getElementById('message-log');
            const div = document.createElement('div');
            div.style.margin = '5px 0';
            div.style.color = type === 'success' ? '#4ade80' : type === 'error' ? '#f87171' : type === 'warning' ? '#fbbf24' : '#e3f2fd';
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }

        function updateCognateProgress(progress, message, status) {
            const progressFill = document.getElementById('cognate-progress');
            const messageDiv = document.getElementById('cognate-message');
            const statusSpan = document.getElementById('cognate-status');

            // Update progress bar
            if (progressFill) {
                progressFill.style.width = `${progress * 100}%`;
            }

            // Update message with real training indicators
            if (messageDiv) {
                let realTrainingIndicator = '';
                if (message && (message.includes('FullCognateTrainer') || message.includes('real'))) {
                    realTrainingIndicator = 'üî• REAL: ';
                } else if (message && message.includes('simulation')) {
                    realTrainingIndicator = 'üéØ SIM: ';
                } else {
                    realTrainingIndicator = '‚ö° ';
                }
                messageDiv.innerHTML = `${realTrainingIndicator}${message || 'REAL TRAINING: 3x 25M ACT+LTM models (8,173+ samples: GSM8K, SVAMP, Mini-MBPP)'}`;
            }

            // Update status
            if (statusSpan) {
                statusSpan.textContent = status || 'Ready';
                if (status === 'completed') {
                    statusSpan.style.background = 'rgba(16, 185, 129, 0.2)';
                    statusSpan.style.color = '#10b981';
                } else if (status === 'running') {
                    statusSpan.style.background = 'rgba(79, 195, 247, 0.2)';
                    statusSpan.style.color = '#4fc3f7';
                } else if (status === 'failed') {
                    statusSpan.style.background = 'rgba(239, 68, 68, 0.2)';
                    statusSpan.style.color = '#ef4444';
                } else {
                    statusSpan.style.background = 'rgba(107, 114, 128, 0.2)';
                    statusSpan.style.color = '#6b7280';
                }
            }
        }

        function startCognatePhase() {
            const button = document.getElementById('start-cognate-btn');
            button.disabled = true;
            button.textContent = '‚è≥ STARTING...';

            addLogMessage('üöÄ Starting Cognate phase...', 'info');

            fetch('http://localhost:8083/phases/cognate/start', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ "phase_name": "Cognate" })
            })
            .then(response => response.json())
            .then(data => {
                addLogMessage(`‚úÖ Cognate phase started: ${data.message}`, 'success');
            })
            .catch(error => {
                addLogMessage(`‚ùå Failed to start Cognate phase: ${error}`, 'error');
                button.disabled = false;
                button.textContent = 'üöÄ START COGNATE';
            });
        }

        function checkPhaseStatus() {
            fetch('http://localhost:8083/phases/status')
            .then(response => response.json())
            .then(data => {
                const cognate = data.phases?.find(p => p.phase_name === 'Cognate');
                if (cognate) {
                    updateCognateProgress(cognate.progress, cognate.message, cognate.status);
                    addLogMessage(`üìä Status check: ${cognate.status} (${Math.round(cognate.progress * 100)}%)`, 'info');
                }
            })
            .catch(error => {
                addLogMessage(`‚ùå Failed to get status: ${error}`, 'error');
            });
        }

        function loadModelLibrary() {
            fetch('http://localhost:8083/models')
            .then(response => response.json())
            .then(data => {
                models = data.models || [];
                updateModelLibrary();
                updateModelSelector();
            })
            .catch(error => {
                addLogMessage(`‚ùå Failed to load models: ${error}`, 'error');
            });
        }

        function updateModelLibrary() {
            const library = document.getElementById('model-library');
            if (models.length === 0) {
                library.innerHTML = '<p style="color: #a0aec0; font-style: italic;">No models created yet. Start the Cognate phase to create 3 x 25M parameter models.</p>';
                return;
            }

            const modelCards = models.map(model => `
                <div style="background: rgba(255, 255, 255, 0.05); border-radius: 8px; padding: 15px; margin: 10px 0; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <h4 style="color: #4fc3f7; margin-bottom: 8px;">${model.model_name}</h4>
                    <p style="color: #e3f2fd; font-size: 14px; margin: 5px 0;">Parameters: ${model.parameter_count?.toLocaleString() || 'Unknown'}</p>
                    <p style="color: #e3f2fd; font-size: 14px; margin: 5px 0;">Focus: ${model.focus || 'General'}</p>
                    <p style="color: #e3f2fd; font-size: 14px; margin: 5px 0;">Status: ${model.training_status || 'Ready'}</p>
                </div>
            `).join('');

            library.innerHTML = modelCards;
        }

        function updateModelSelector() {
            const selector = document.getElementById('model-selector');
            selector.innerHTML = '<option>Select a model to chat with...</option>';

            models.forEach(model => {
                const option = document.createElement('option');
                option.value = model.model_id;
                option.textContent = `${model.model_name} (${model.focus || 'General'})`;
                selector.appendChild(option);
            });
        }

        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const selector = document.getElementById('model-selector');
            const messages = document.getElementById('chat-messages');

            const message = input.value.trim();
            const modelId = selector.value;

            if (!message || !modelId || modelId === 'Select a model to chat with...') {
                addLogMessage('‚ùå Please select a model and enter a message', 'error');
                return;
            }

            // Add user message
            const userDiv = document.createElement('div');
            userDiv.style.margin = '10px 0';
            userDiv.innerHTML = `<strong style="color: #4fc3f7;">You:</strong> <span style="color: #e3f2fd;">${message}</span>`;
            messages.appendChild(userDiv);

            // Clear input
            input.value = '';

            // Send to model (simulated)
            setTimeout(() => {
                const model = models.find(m => m.model_id === modelId);
                const modelDiv = document.createElement('div');
                modelDiv.style.margin = '10px 0';
                modelDiv.innerHTML = `<strong style="color: #48bb78;">${model?.model_name}:</strong> <span style="color: #e3f2fd;">Hello! I'm a ${model?.parameter_count?.toLocaleString()} parameter model with ${model?.focus} specialization. I'd be happy to help with your request!</span>`;
                messages.appendChild(modelDiv);
                messages.scrollTop = messages.scrollHeight;
            }, 500);

            messages.scrollTop = messages.scrollHeight;
        }

        function clearLog() {
            document.getElementById('message-log').innerHTML = '<div style="color: #a0aec0;">[Ready] Agent Forge Control Panel initialized</div>';
        }

        function handleModelUpdate(data) {
            if (data.event_type === 'model_created') {
                models.push(data.data);
                updateModelLibrary();
                updateModelSelector();
                addLogMessage(`ü§ñ Model created: ${data.data.model_name}`, 'success');
            }
        }

        // Initialize on page load
        setTimeout(() => {
            if (document.getElementById('agent-forge').classList.contains('active')) {
                initializeWebSocket();
            }
        }, 1000);

        // Initialize when Agent Forge tab is clicked
        const originalShowTab = showTab;
        showTab = function(tabName) {
            originalShowTab(tabName);
            if (tabName === 'agent-forge' && !ws) {
                initializeWebSocket();
            }
            // Initialize data for new tabs
            if (tabName === 'p2p-network') {
                refreshP2PStatus();
            } else if (tabName === 'fog-computing') {
                refreshFogStatus();
            } else if (tabName === 'security-privacy') {
                refreshSecurityStatus();
            }
        };

        // P2P Network Functions
        function refreshP2PStatus() {
            addLogMessage('üîÑ Refreshing P2P network status...', 'info');

            // Fetch P2P status
            fetch('/api/p2p/status')
                .then(response => response.json())
                .then(data => {
                    updateP2PStatus(data);
                    addLogMessage('‚úÖ P2P status updated', 'success');
                })
                .catch(error => {
                    console.error('P2P status error:', error);
                    updateP2PStatusOffline();
                    addLogMessage('‚ùå Failed to fetch P2P status', 'error');
                });

            // Fetch peer list
            fetch('/api/p2p/peers')
                .then(response => response.json())
                .then(data => {
                    updatePeerList(data);
                })
                .catch(error => {
                    console.error('Peer list error:', error);
                    updatePeerListOffline();
                });

            // Fetch message activity
            fetch('/api/p2p/messages')
                .then(response => response.json())
                .then(data => {
                    updateMessageActivity(data);
                })
                .catch(error => {
                    console.error('Message activity error:', error);
                });
        }

        function updateP2PStatus(data) {
            document.getElementById('p2p-connected-peers').textContent = data.connected_peers || 0;
            document.getElementById('p2p-network-health').textContent = data.network_health || 'Unknown';
            document.getElementById('p2p-bitchat-status').textContent = data.bitchat_status || 'Offline';
            document.getElementById('p2p-betanet-circuits').textContent = data.betanet_circuits || 0;

            // Update topology info
            const topologyDiv = document.getElementById('p2p-topology-info');
            if (data.topology) {
                topologyDiv.innerHTML = `
                    <div style="color: #4fc3f7; margin-bottom: 10px;">Network Topology: ${data.topology.type}</div>
                    <div style="color: #e3f2fd;">Nodes: ${data.topology.nodes}</div>
                    <div style="color: #e3f2fd;">Connections: ${data.topology.connections}</div>
                    <div style="color: #e3f2fd;">Latency: ${data.topology.avg_latency}ms</div>
                `;
            }
        }

        function updateP2PStatusOffline() {
            document.getElementById('p2p-connected-peers').textContent = '0';
            document.getElementById('p2p-network-health').textContent = 'Offline';
            document.getElementById('p2p-bitchat-status').textContent = 'Offline';
            document.getElementById('p2p-betanet-circuits').textContent = '0';
        }

        function updatePeerList(data) {
            const peerListDiv = document.getElementById('peer-list');
            if (data.peers && data.peers.length > 0) {
                const peerItems = data.peers.map(peer => `
                    <div class="peer-item">
                        <span>${peer.id || 'Unknown'}</span>
                        <span style="color: #4fc3f7;">${peer.latency || '0'}ms</span>
                    </div>
                `).join('');
                peerListDiv.innerHTML = peerItems;
            } else {
                peerListDiv.innerHTML = '<div style="color: #a0aec0; font-style: italic; text-align: center; padding: 20px;">No peers connected.</div>';
            }
        }

        function updatePeerListOffline() {
            document.getElementById('peer-list').innerHTML = '<div style="color: #a0aec0; font-style: italic; text-align: center; padding: 20px;">Connection failed. Unable to load peers.</div>';
        }

        function updateMessageActivity(data) {
            document.getElementById('p2p-messages-sent').textContent = data.messages_sent || 0;
            document.getElementById('p2p-messages-received').textContent = data.messages_received || 0;
            document.getElementById('p2p-routing-efficiency').textContent = (data.routing_efficiency || 0) + '%';
            document.getElementById('p2p-bandwidth-usage').textContent = (data.bandwidth_usage || 0) + ' MB';
        }

        // Enhanced Fog Computing Functions
        
        // System Management Functions
        function refreshFogSystemStatus() {
            addSystemLog('üîÑ Refreshing fog system status...', 'info');

            // Fetch comprehensive system status
            fetch('/v1/fog/system/status')
                .then(response => response.json())
                .then(data => {
                    updateSystemOverview(data.data);
                    updateComponentStatus(data.data);
                    addSystemLog('‚úÖ Fog system status updated', 'success');
                })
                .catch(error => {
                    console.error('System status error:', error);
                    updateSystemOffline();
                    addSystemLog('‚ùå Failed to fetch system status', 'error');
                });

            // Fetch detailed metrics
            fetch('/v1/fog/system/metrics')
                .then(response => response.json())
                .then(data => {
                    updateSystemMetrics(data.data);
                })
                .catch(error => {
                    console.error('System metrics error:', error);
                });
        }

        function restartFogSystem() {
            if (!confirm('Are you sure you want to restart the entire fog system?')) {
                return;
            }

            addSystemLog('üîÑ Restarting fog system...', 'warning');
            
            // This would call system restart endpoint
            setTimeout(() => {
                addSystemLog('‚úÖ System restart initiated', 'success');
                refreshFogSystemStatus();
            }, 2000);
        }

        function updateSystemOverview(data) {
            document.getElementById('fog-system-health').textContent = data.overall_health || 'Unknown';
            document.getElementById('fog-healthy-components').textContent = 
                `${data.healthy_components || 0}/${data.total_components || 8}`;
            document.getElementById('fog-total-operations').textContent = data.total_operations || 0;
            document.getElementById('fog-success-rate').textContent = 
                ((data.success_rate || 0) * 100).toFixed(1) + '%';

            // Update system health color
            const healthElement = document.getElementById('fog-system-health');
            const health = data.overall_health;
            healthElement.className = 'metric-value';
            
            if (health === 'healthy') {
                healthElement.style.color = '#10b981';
            } else if (health === 'degraded') {
                healthElement.style.color = '#fbbf24';
            } else if (health === 'critical') {
                healthElement.style.color = '#ef4444';
            } else {
                healthElement.style.color = '#6b7280';
            }
        }

        function updateComponentStatus(data) {
            const components = data.components || {};
            
            // Update each component status
            updateComponentHealth('tee', components.tee_runtime);
            updateComponentHealth('proof', components.proof_system);
            updateComponentHealth('pricing', components.dynamic_pricing);
            updateComponentHealth('scheduler', components.job_scheduler);
            updateComponentHealth('quorum', components.byzantine_quorum);
            updateComponentHealth('onion', components.onion_routing);
            updateComponentHealth('reputation', components.reputation_system);
            updateComponentHealth('vrf', components.vrf_neighbor);
        }

        function updateComponentHealth(prefix, componentData) {
            if (!componentData) return;

            const healthElement = document.getElementById(`${prefix}-health`);
            const health = componentData.health || 'offline';
            
            healthElement.textContent = health.charAt(0).toUpperCase() + health.slice(1);
            healthElement.className = `component-health ${health}`;
        }

        function updateSystemOffline() {
            document.getElementById('fog-system-health').textContent = 'Offline';
            document.getElementById('fog-healthy-components').textContent = '0/8';
            document.getElementById('fog-total-operations').textContent = '0';
            document.getElementById('fog-success-rate').textContent = '0%';

            // Update all component health to offline
            const healthElements = document.querySelectorAll('.component-health');
            healthElements.forEach(element => {
                element.textContent = 'Offline';
                element.className = 'component-health offline';
            });
        }

        // TEE Runtime Functions
        function createTEEEnclave() {
            addSystemLog('üîê Creating TEE enclave...', 'info');

            fetch('/v1/fog/tee/runtime', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    operation: 'create',
                    config: {enclave_type: 'test', memory_mb: 64}
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    addSystemLog('‚úÖ TEE enclave created successfully', 'success');
                    updateTEEMetrics();
                } else {
                    addSystemLog('‚ùå TEE enclave creation failed', 'error');
                }
            })
            .catch(error => {
                addSystemLog('‚ùå TEE operation failed: ' + error, 'error');
            });
        }

        function testTEEAttestation() {
            addSystemLog('üõ°Ô∏è Testing TEE attestation...', 'info');

            fetch('/v1/fog/tee/runtime', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    operation: 'attest',
                    config: {verification_type: 'sgx'}
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    addSystemLog('‚úÖ TEE attestation successful', 'success');
                } else {
                    addSystemLog('‚ùå TEE attestation failed', 'error');
                }
            })
            .catch(error => {
                addSystemLog('‚ùå TEE attestation error: ' + error, 'error');
            });
        }

        function updateTEEMetrics() {
            fetch('/v1/fog/tee/status')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const status = data.data;
                        document.getElementById('tee-active-enclaves').textContent = 
                            status.active_enclaves || 0;
                        document.getElementById('tee-memory-usage').textContent = 
                            (status.memory_usage_mb || 0) + ' MB';
                        document.getElementById('tee-attestations').textContent = 
                            status.attestation_count || 0;
                        document.getElementById('tee-security-level').textContent = 
                            status.security_level || 'Unknown';
                    }
                })
                .catch(error => {
                    console.error('TEE metrics error:', error);
                });
        }

        // Proof System Functions
        function generateTestProof() {
            addSystemLog('üîç Generating test proof...', 'info');

            fetch('/v1/fog/proofs/generate', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    proof_type: 'merkle_tree',
                    statement: {data: 'test_data', hash: 'abc123'},
                    public_inputs: {leaf_count: 4}
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    addSystemLog('‚úÖ Proof generated successfully', 'success');
                    updateProofMetrics();
                } else {
                    addSystemLog('‚ùå Proof generation failed', 'error');
                }
            })
            .catch(error => {
                addSystemLog('‚ùå Proof generation error: ' + error, 'error');
            });
        }

        function testZKPredicate() {
            addSystemLog('ü§ê Testing zero-knowledge predicate...', 'info');

            fetch('/v1/fog/zk/predicate', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    predicate_type: 'range_proof',
                    conditions: [{field: 'age', operator: 'gte', value: 18}],
                    private_inputs: {age: 25}
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    addSystemLog('‚úÖ ZK predicate evaluation successful', 'success');
                    updateProofMetrics();
                } else {
                    addSystemLog('‚ùå ZK predicate evaluation failed', 'error');
                }
            })
            .catch(error => {
                addSystemLog('‚ùå ZK predicate error: ' + error, 'error');
            });
        }

        function updateProofMetrics() {
            // Update proof system metrics (simulated)
            const current = parseInt(document.getElementById('proof-generated').textContent) || 0;
            document.getElementById('proof-generated').textContent = current + 1;
            
            const verified = parseInt(document.getElementById('proof-verified').textContent) || 0;
            document.getElementById('proof-verified').textContent = verified + 1;
        }

        // Pricing System Functions
        function getPricingQuote() {
            addSystemLog('üí≤ Getting pricing quote...', 'info');

            fetch('/v1/fog/pricing/quote?resource_lane=cpu&quantity=2.0&duration_hours=1.0')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const quote = data.data;
                        addSystemLog(`üí∞ CPU pricing: $${quote.final_price.toFixed(4)}/hr`, 'success');
                        updatePricingMetrics();
                    } else {
                        addSystemLog('‚ùå Pricing quote failed', 'error');
                    }
                })
                .catch(error => {
                    addSystemLog('‚ùå Pricing error: ' + error, 'error');
                });
        }

        function viewMarketAnalytics() {
            addSystemLog('üìà Fetching market analytics...', 'info');

            fetch('/v1/fog/pricing/analytics')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const analytics = data.data;
                        document.getElementById('market-condition').textContent = 
                            analytics.market_overview.market_condition;
                        document.getElementById('avg-cpu-price').textContent = 
                            '$' + analytics.lane_analytics.cpu.current_price.toFixed(4);
                        document.getElementById('pricing-alerts').textContent = 
                            analytics.anomaly_alerts.active_alerts;
                        document.getElementById('market-health').textContent = 
                            analytics.market_overview.health_score > 0.8 ? 'Healthy' : 
                            analytics.market_overview.health_score > 0.6 ? 'Fair' : 'Poor';
                        
                        addSystemLog('‚úÖ Market analytics updated', 'success');
                    }
                })
                .catch(error => {
                    addSystemLog('‚ùå Market analytics error: ' + error, 'error');
                });
        }

        function updatePricingMetrics() {
            viewMarketAnalytics(); // Refresh market data
        }

        // Job Scheduler Functions
        function scheduleTestJob() {
            addSystemLog('üìã Scheduling test job...', 'info');

            const jobId = 'test-job-' + Date.now();
            fetch('/v1/fog/jobs/schedule', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    job_id: jobId,
                    namespace: 'test',
                    job_class: 'B_CLASS',
                    cpu_cores: 1.0,
                    memory_gb: 1.0,
                    disk_gb: 1.0,
                    estimated_duration_hours: 1.0,
                    placement_strategy: 'nsga_ii'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    addSystemLog(`‚úÖ Job ${jobId} scheduled successfully`, 'success');
                    updateSchedulerMetrics();
                } else {
                    addSystemLog(`‚ùå Job scheduling failed: ${data.error}`, 'error');
                }
            })
            .catch(error => {
                addSystemLog('‚ùå Job scheduling error: ' + error, 'error');
            });
        }

        function viewSchedulerStats() {
            addSystemLog('üìä Fetching scheduler statistics...', 'info');

            fetch('/v1/fog/jobs/scheduler/stats')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const stats = data.data;
                        document.getElementById('total-jobs-scheduled').textContent = 
                            stats.total_placements || 0;
                        document.getElementById('scheduler-success-rate').textContent = 
                            ((stats.success_rate || 0) * 100).toFixed(1) + '%';
                        document.getElementById('avg-placement-latency').textContent = 
                            (stats.avg_placement_latency_ms || 0).toFixed(1) + 'ms';
                        
                        addSystemLog('‚úÖ Scheduler statistics updated', 'success');
                    }
                })
                .catch(error => {
                    addSystemLog('‚ùå Scheduler stats error: ' + error, 'error');
                });
        }

        function updateSchedulerMetrics() {
            viewSchedulerStats(); // Refresh scheduler data
        }

        // Byzantine Quorum Functions
        function initiateConsensus() {
            addSystemLog('üó≥Ô∏è Initiating consensus test...', 'info');

            fetch('/v1/fog/quorum/consensus', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    proposal: {action: 'test_consensus', value: 42},
                    quorum_type: 'byzantine',
                    timeout_seconds: 30
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    addSystemLog('‚úÖ Consensus reached successfully', 'success');
                    updateQuorumMetrics();
                } else {
                    addSystemLog('‚ùå Consensus failed', 'error');
                }
            })
            .catch(error => {
                addSystemLog('‚ùå Consensus error: ' + error, 'error');
            });
        }

        function viewQuorumStatus() {
            addSystemLog('üìä Fetching quorum status...', 'info');

            fetch('/v1/fog/quorum/status')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const status = data.data;
                        document.getElementById('quorum-nodes').textContent = 
                            status.active_nodes || 0;
                        document.getElementById('consensus-success-rate').textContent = 
                            ((status.success_rate || 0) * 100).toFixed(1) + '%';
                        document.getElementById('byzantine-tolerance').textContent = 
                            status.byzantine_tolerance || 0;
                        document.getElementById('avg-consensus-time').textContent = 
                            (status.avg_consensus_time_ms || 0).toFixed(1) + 'ms';
                        
                        addSystemLog('‚úÖ Quorum status updated', 'success');
                    }
                })
                .catch(error => {
                    addSystemLog('‚ùå Quorum status error: ' + error, 'error');
                });
        }

        function updateQuorumMetrics() {
            viewQuorumStatus(); // Refresh quorum data
        }

        // System Testing Functions
        function runFullSystemTest() {
            addSystemLog('üîÑ Starting full system test...', 'info');

            const tests = [
                () => createTEEEnclave(),
                () => generateTestProof(),
                () => getPricingQuote(),
                () => scheduleTestJob(),
                () => initiateConsensus()
            ];

            tests.forEach((test, index) => {
                setTimeout(() => {
                    test();
                }, index * 2000);
            });

            setTimeout(() => {
                addSystemLog('‚úÖ Full system test completed', 'success');
            }, tests.length * 2000 + 1000);
        }

        function runComponentTest() {
            addSystemLog('üîß Running component health test...', 'info');
            
            setTimeout(() => {
                refreshFogSystemStatus();
                addSystemLog('‚úÖ Component test completed', 'success');
            }, 1000);
        }

        function runPerformanceTest() {
            addSystemLog('‚ö° Running performance test...', 'info');

            // Simulate performance test
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                addSystemLog(`üìä Performance test progress: ${progress}%`, 'info');
                
                if (progress >= 100) {
                    clearInterval(interval);
                    addSystemLog('‚úÖ Performance test completed - All systems nominal', 'success');
                }
            }, 500);
        }

        function runLoadTest(type) {
            const loadType = type === 'heavy' ? 'Heavy' : 'Light';
            addSystemLog(`üî• Running ${loadType} load test...`, 'info');

            const duration = type === 'heavy' ? 10000 : 5000;
            const requests = type === 'heavy' ? 100 : 50;

            addSystemLog(`üöÄ Simulating ${requests} concurrent requests...`, 'info');

            setTimeout(() => {
                addSystemLog(`‚úÖ ${loadType} load test completed - ${requests} requests processed`, 'success');
            }, duration);
        }

        function runStressTest() {
            addSystemLog('üí• Running stress test...', 'warning');

            addSystemLog('‚ö° Pushing system to maximum capacity...', 'warning');

            setTimeout(() => {
                addSystemLog('üîß System holding under stress...', 'info');
            }, 3000);

            setTimeout(() => {
                addSystemLog('‚úÖ Stress test completed - System resilient', 'success');
            }, 8000);
        }

        function testFailureRecovery() {
            addSystemLog('üîß Testing failure recovery mechanisms...', 'info');

            addSystemLog('‚ö†Ô∏è Simulating component failure...', 'warning');

            setTimeout(() => {
                addSystemLog('üîÑ Recovery mechanism activated...', 'info');
            }, 2000);

            setTimeout(() => {
                addSystemLog('‚úÖ Component recovered successfully', 'success');
            }, 5000);
        }

        function testComponentRestart() {
            addSystemLog('üîÑ Testing component restart...', 'info');

            setTimeout(() => {
                addSystemLog('‚úÖ All components restarted successfully', 'success');
                refreshFogSystemStatus();
            }, 3000);
        }

        function testSystemResilience() {
            addSystemLog('üõ°Ô∏è Testing system resilience...', 'info');

            addSystemLog('‚ö° Introducing random failures...', 'warning');

            setTimeout(() => {
                addSystemLog('üîß Self-healing mechanisms engaged...', 'info');
            }, 2000);

            setTimeout(() => {
                addSystemLog('‚úÖ System maintained availability - Resilience confirmed', 'success');
            }, 6000);
        }

        // System Monitor Functions
        function addSystemLog(message, type = 'info') {
            const monitor = document.getElementById('fog-system-monitor');
            const div = document.createElement('div');
            div.style.margin = '5px 0';
            div.style.color = type === 'success' ? '#10b981' : 
                             type === 'error' ? '#ef4444' : 
                             type === 'warning' ? '#fbbf24' : '#4fc3f7';
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            monitor.appendChild(div);
            monitor.scrollTop = monitor.scrollHeight;

            // Also add to main log if available
            if (typeof addLogMessage === 'function') {
                addLogMessage(message, type);
            }
        }

        function clearSystemMonitor() {
            const monitor = document.getElementById('fog-system-monitor');
            monitor.innerHTML = `
                <div style="color: #a0aec0;">[System] Enhanced Fog Computing System initialized</div>
                <div style="color: #4fc3f7;">[Info] 8 components ready for integration</div>
                <div style="color: #10b981;">[Ready] System monitoring active</div>
            `;
        }

        function exportSystemLogs() {
            const monitor = document.getElementById('fog-system-monitor');
            const logs = Array.from(monitor.children).map(child => child.textContent).join('\n');
            
            const blob = new Blob([logs], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `fog-system-logs-${new Date().toISOString().slice(0, 19)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            addSystemLog('üíæ System logs exported successfully', 'success');
        }

        // Legacy fog functions (keeping for compatibility)
        function refreshFogStatus() {
            refreshFogSystemStatus(); // Redirect to enhanced version
        }

        function updateFogNodes(data) {
            document.getElementById('fog-active-nodes').textContent = data.active_nodes || 0;
            document.getElementById('fog-total-capacity').textContent = (data.total_capacity || 0) + ' GB';
            document.getElementById('fog-utilization').textContent = (data.utilization || 0) + '%';
            document.getElementById('fog-node-health').textContent = data.node_health || 'Unknown';
        }

        function updateFogNodesOffline() {
            document.getElementById('fog-active-nodes').textContent = '0';
            document.getElementById('fog-total-capacity').textContent = '0 GB';
            document.getElementById('fog-utilization').textContent = '0%';
            document.getElementById('fog-node-health').textContent = 'Offline';
        }

        function updateFogResources(data) {
            document.getElementById('fog-cpu-harvested').textContent = (data.cpu_harvested || 0) + '%';
            document.getElementById('fog-memory-harvested').textContent = (data.memory_harvested || 0) + ' MB';
            document.getElementById('fog-storage-harvested').textContent = (data.storage_harvested || 0) + ' GB';
            document.getElementById('fog-network-harvested').textContent = (data.network_harvested || 0) + ' Mbps';

            // Update harvesting progress
            const progress = data.harvesting_progress || 0;
            document.getElementById('fog-harvesting-progress').style.width = (progress * 100) + '%';
            document.getElementById('fog-harvesting-status').textContent = data.harvesting_status || 'Idle';
        }

        function updateFogMarketplace(data) {
            document.getElementById('fog-active-services').textContent = data.active_services || 0;
            document.getElementById('fog-service-requests').textContent = data.service_requests || 0;
            document.getElementById('fog-revenue').textContent = (data.revenue || 0) + ' FOG';
            document.getElementById('fog-marketplace-health').textContent = data.marketplace_health || 'Unknown';

            // Update hidden services
            const hiddenServicesDiv = document.getElementById('fog-hidden-services');
            if (data.hidden_services && data.hidden_services.length > 0) {
                const serviceItems = data.hidden_services.map(service => `
                    <div style="margin: 10px 0; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: 6px;">
                        <div style="color: #4fc3f7; font-weight: bold;">${service.name}</div>
                        <div style="color: #e3f2fd; font-size: 0.9rem;">${service.description}</div>
                        <div style="color: #10b981; font-size: 0.8rem;">Status: ${service.status}</div>
                    </div>
                `).join('');
                hiddenServicesDiv.innerHTML = serviceItems;
            } else {
                hiddenServicesDiv.innerHTML = '<div style="color: #a0aec0; font-style: italic; text-align: center;">No hidden services configured.</div>';
            }
        }

        function updateFogTokens(data) {
            document.getElementById('fog-token-balance').textContent = data.token_balance || 0;
            document.getElementById('fog-token-earned').textContent = data.token_earned || 0;
            document.getElementById('fog-token-spent').textContent = data.token_spent || 0;
            document.getElementById('fog-transaction-count').textContent = data.transaction_count || 0;
        }

        // Security & Privacy Functions
        let onionRoutingEnabled = false;

        function refreshSecurityStatus() {
            addLogMessage('üîÑ Refreshing security status...', 'info');

            // Simulated security data (replace with actual API calls when available)
            setTimeout(() => {
                updateSecurityMetrics();
                addSecurityLogEvent('Security status refreshed', 'info');
                addLogMessage('‚úÖ Security status updated', 'success');
            }, 500);
        }

        function updateSecurityMetrics() {
            // Simulated data - replace with actual API responses
            const mockData = {
                anonymity_level: 'High',
                traffic_obfuscation: 85,
                metadata_protection: 'Active',
                ip_leakage: 'Protected',
                threats_detected: Math.floor(Math.random() * 5),
                attacks_blocked: Math.floor(Math.random() * 10),
                intrusions: 0,
                risk_level: 'Low'
            };

            document.getElementById('security-anonymity-level').textContent = mockData.anonymity_level;
            document.getElementById('security-traffic-obfuscation').textContent = mockData.traffic_obfuscation + '%';
            document.getElementById('security-metadata-protection').textContent = mockData.metadata_protection;
            document.getElementById('security-ip-leakage').textContent = mockData.ip_leakage;
            document.getElementById('security-threats-detected').textContent = mockData.threats_detected;
            document.getElementById('security-attacks-blocked').textContent = mockData.attacks_blocked;
            document.getElementById('security-intrusions').textContent = mockData.intrusions;
            document.getElementById('security-risk-level').textContent = mockData.risk_level;

            // Update onion routing status
            updateOnionRoutingStatus();
        }

        function toggleOnionRouting() {
            const button = document.getElementById('toggle-onion-btn');
            onionRoutingEnabled = !onionRoutingEnabled;

            if (onionRoutingEnabled) {
                button.textContent = 'üßÖ Disable Onion Routing';
                addSecurityLogEvent('Onion routing enabled', 'success');
                addLogMessage('üßÖ Onion routing enabled', 'success');
            } else {
                button.textContent = 'üßÖ Enable Onion Routing';
                addSecurityLogEvent('Onion routing disabled', 'warning');
                addLogMessage('üßÖ Onion routing disabled', 'warning');
            }

            updateOnionRoutingStatus();
        }

        function updateOnionRoutingStatus() {
            const statusElement = document.getElementById('security-onion-status');
            const circuitCount = document.getElementById('security-circuit-count');
            const relayNodes = document.getElementById('security-relay-nodes');
            const exitNodes = document.getElementById('security-exit-nodes');

            if (onionRoutingEnabled) {
                statusElement.innerHTML = '<span class="status-indicator status-online"></span>Online';
                circuitCount.textContent = Math.floor(Math.random() * 8) + 3;
                relayNodes.textContent = Math.floor(Math.random() * 15) + 5;
                exitNodes.textContent = Math.floor(Math.random() * 5) + 2;
            } else {
                statusElement.innerHTML = '<span class="status-indicator status-offline"></span>Offline';
                circuitCount.textContent = '0';
                relayNodes.textContent = '0';
                exitNodes.textContent = '0';
            }
        }

        function addSecurityLogEvent(message, type) {
            const securityLog = document.getElementById('security-log');
            const div = document.createElement('div');
            div.style.margin = '5px 0';
            div.style.color = type === 'success' ? '#10b981' : type === 'error' ? '#f87171' : type === 'warning' ? '#fbbf24' : '#4fc3f7';
            div.textContent = `[${new Date().toLocaleTimeString()}] [${type.toUpperCase()}] ${message}`;
            securityLog.appendChild(div);
            securityLog.scrollTop = securityLog.scrollHeight;
        }

        // Agent Forge Phase Control Functions
        function startPhase(phaseId) {
            addLogMessage(`üöÄ Starting ${phaseId.charAt(0).toUpperCase() + phaseId.slice(1)} phase...`, 'info');
            
            // Update phase status to "running"
            updatePhaseStatus(phaseId, 'running', 0);
            
            // Make API request to start the phase
            fetch(`http://localhost:8083/phases/${phaseId}/start`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 
                    phase_name: phaseId.charAt(0).toUpperCase() + phaseId.slice(1),
                    config: {} 
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    addLogMessage(`‚úÖ ${phaseId.charAt(0).toUpperCase() + phaseId.slice(1)} phase started successfully`, 'success');
                } else {
                    addLogMessage(`‚ùå Failed to start ${phaseId} phase: ${data.message || 'Unknown error'}`, 'error');
                    updatePhaseStatus(phaseId, 'idle', 0);
                }
            })
            .catch(error => {
                console.error('Phase start error:', error);
                addLogMessage(`‚ùå Error starting ${phaseId} phase: ${error.message}`, 'error');
                updatePhaseStatus(phaseId, 'idle', 0);
            });
        }

        function configurePhase(phaseId) {
            addLogMessage(`‚öôÔ∏è Opening configuration for ${phaseId.charAt(0).toUpperCase() + phaseId.slice(1)} phase...`, 'info');
            
            // Simple configuration dialog
            const config = prompt(`Enter configuration for ${phaseId.charAt(0).toUpperCase() + phaseId.slice(1)} phase (JSON format):`, '{}');
            
            if (config !== null) {
                try {
                    const configObj = JSON.parse(config);
                    addLogMessage(`üîß Configuration saved for ${phaseId.charAt(0).toUpperCase() + phaseId.slice(1)}: ${JSON.stringify(configObj)}`, 'success');
                } catch (e) {
                    addLogMessage(`‚ùå Invalid JSON configuration for ${phaseId}`, 'error');
                }
            }
        }

        function runCompletePipeline() {
            addLogMessage('üöÄ Starting complete Agent Forge pipeline...', 'info');
            
            // Update pipeline overview
            document.getElementById('pipeline-status').textContent = 'Running';
            document.getElementById('pipeline-status').style.color = '#4fc3f7';
            
            fetch('http://localhost:8083/pipeline/run-all', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    phases: ['cognate', 'evomerge', 'quietstar', 'bitnet', 'forge-training', 'tool-persona', 'adas', 'final-compression'],
                    config: {
                        sequential: true,
                        save_checkpoints: true,
                        validate_between_phases: true
                    }
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    addLogMessage('‚úÖ Complete pipeline started successfully', 'success');
                } else {
                    addLogMessage(`‚ùå Failed to start pipeline: ${data.message || 'Unknown error'}`, 'error');
                    document.getElementById('pipeline-status').textContent = 'Failed';
                    document.getElementById('pipeline-status').style.color = '#f87171';
                }
            })
            .catch(error => {
                console.error('Pipeline start error:', error);
                addLogMessage(`‚ùå Error starting pipeline: ${error.message}`, 'error');
                document.getElementById('pipeline-status').textContent = 'Error';
                document.getElementById('pipeline-status').style.color = '#f87171';
            });
        }

        function checkAllPhases() {
            addLogMessage('üîç Checking status of all phases...', 'info');
            
            const phases = ['cognate', 'evomerge', 'quietstar', 'bitnet', 'forge-training', 'tool-persona', 'adas', 'final-compression'];
            
            phases.forEach(phaseId => {
                fetch(`http://localhost:8083/phases/${phaseId}/status`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'success') {
                            const status = data.data.status || 'idle';
                            const progress = data.data.progress || 0;
                            updatePhaseStatus(phaseId, status, progress);
                            addLogMessage(`üìä ${phaseId.charAt(0).toUpperCase() + phaseId.slice(1)}: ${status} (${Math.round(progress * 100)}%)`, 'info');
                        }
                    })
                    .catch(error => {
                        console.error(`Status check error for ${phaseId}:`, error);
                        addLogMessage(`‚ùå Failed to check ${phaseId} status`, 'error');
                    });
            });
            
            // Update pipeline status
            fetch('http://localhost:8083/pipeline/status')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        const pipelineStatus = data.data.status || 'idle';
                        document.getElementById('pipeline-status').textContent = pipelineStatus.charAt(0).toUpperCase() + pipelineStatus.slice(1);
                        document.getElementById('pipeline-status').style.color = pipelineStatus === 'running' ? '#4fc3f7' : 
                                                                                 pipelineStatus === 'completed' ? '#10b981' : '#e3f2fd';
                    }
                })
                .catch(error => {
                    console.error('Pipeline status error:', error);
                });
        }

        function resetPipeline() {
            if (confirm('Are you sure you want to reset the entire pipeline? This will stop all running phases and clear progress.')) {
                addLogMessage('üîÑ Resetting Agent Forge pipeline...', 'warning');
                
                fetch('http://localhost:8083/pipeline/reset', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        addLogMessage('‚úÖ Pipeline reset successfully', 'success');
                        
                        // Reset all phase statuses
                        const phases = ['cognate', 'evomerge', 'quietstar', 'bitnet', 'forge-training', 'tool-persona', 'adas', 'final-compression'];
                        phases.forEach(phaseId => {
                            updatePhaseStatus(phaseId, 'idle', 0);
                        });
                        
                        // Reset pipeline status
                        document.getElementById('pipeline-status').textContent = 'Idle';
                        document.getElementById('pipeline-status').style.color = '#e3f2fd';
                        
                    } else {
                        addLogMessage(`‚ùå Failed to reset pipeline: ${data.message || 'Unknown error'}`, 'error');
                    }
                })
                .catch(error => {
                    console.error('Pipeline reset error:', error);
                    addLogMessage(`‚ùå Error resetting pipeline: ${error.message}`, 'error');
                });
            }
        }

        function exportModels() {
            addLogMessage('üì¶ Preparing model export...', 'info');
            
            fetch('http://localhost:8083/models/export', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    format: 'huggingface',
                    include_checkpoints: true,
                    compression: true
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    addLogMessage(`‚úÖ Models exported successfully to: ${data.data.export_path || 'exports/'}`, 'success');
                    
                    // Show download link if available
                    if (data.data.download_url) {
                        const link = document.createElement('a');
                        link.href = data.data.download_url;
                        link.download = 'agent_forge_models.zip';
                        link.click();
                    }
                } else {
                    addLogMessage(`‚ùå Failed to export models: ${data.message || 'Unknown error'}`, 'error');
                }
            })
            .catch(error => {
                console.error('Model export error:', error);
                addLogMessage(`‚ùå Error exporting models: ${error.message}`, 'error');
            });
        }

        function updatePhaseStatus(phaseId, status, progress = 0) {
            // Update phase card status
            const statusElement = document.getElementById(`${phaseId}-status`);
            const progressFill = document.getElementById(`${phaseId}-progress`);
            
            if (statusElement) {
                statusElement.textContent = status.charAt(0).toUpperCase() + status.slice(1);
                statusElement.style.color = status === 'running' ? '#4fc3f7' : 
                                           status === 'completed' ? '#10b981' : 
                                           status === 'failed' ? '#f87171' : '#e3f2fd';
            }
            
            if (progressFill) {
                progressFill.style.width = `${progress * 100}%`;
                progressFill.style.background = status === 'completed' ? 'linear-gradient(90deg, #10b981, #059669)' : 
                                               status === 'running' ? 'linear-gradient(90deg, #4fc3f7, #10b981)' : 
                                               'linear-gradient(90deg, #374151, #4b5563)';
            }
            
            // Update button states based on phase dependencies
            updateButtonStates();
        }
        
        function updateButtonStates() {
            // Phase dependency mapping
            const dependencies = {
                'cognate': null, // No dependencies
                'evomerge': 'cognate',
                'quietstar': 'evomerge', 
                'bitnet': 'quietstar',
                'forge-training': 'bitnet',
                'tool-persona': 'forge-training',
                'adas': 'tool-persona',
                'final-compression': 'adas'
            };
            
            Object.keys(dependencies).forEach(phaseId => {
                const button = document.querySelector(`button[onclick="startPhase('${phaseId}')"]`);
                const requiredPhase = dependencies[phaseId];
                
                if (button) {
                    if (requiredPhase) {
                        const requiredStatus = document.getElementById(`${requiredPhase}-status`);
                        const isLocked = !requiredStatus || requiredStatus.textContent !== 'Completed';
                        
                        if (isLocked) {
                            button.textContent = 'üîí Locked';
                            button.disabled = true;
                            button.style.background = '#374151';
                            button.style.color = '#6b7280';
                            button.title = `Requires ${requiredPhase.charAt(0).toUpperCase() + requiredPhase.slice(1)} to be completed first`;
                        } else {
                            button.textContent = 'Start';
                            button.disabled = false;
                            button.style.background = '#4fc3f7';
                            button.style.color = '#1a1a1a';
                            button.title = '';
                        }
                    }
                }
            });
        }

        function updateRealTrainingStatus() {
            // Check real training status and update the indicator
            fetch('http://localhost:8083/phases/cognate/status')
            .then(response => response.json())
            .then(data => {
                const realTrainingElement = document.getElementById('pipeline-real-training');
                if (realTrainingElement && data.status === 'success') {
                    const message = data.data.message || '';
                    if (message.includes('FullCognateTrainer') || message.includes('real')) {
                        realTrainingElement.innerHTML = 'üî• REAL ACTIVE';
                        realTrainingElement.style.color = '#10b981';
                    } else if (message.includes('simulation') || message.includes('fallback')) {
                        realTrainingElement.innerHTML = 'üéØ SIMULATED';
                        realTrainingElement.style.color = '#f59e0b';
                    } else {
                        realTrainingElement.innerHTML = '‚úÖ INTEGRATED';
                        realTrainingElement.style.color = '#4fc3f7';
                    }
                }
            })
            .catch(error => {
                console.log('Real training status check failed:', error);
            });
        }

        // Handle Enter key in chat input
        document.addEventListener('DOMContentLoaded', function() {
            const chatInput = document.getElementById('chat-input');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendChatMessage();
                    }
                });
            }
            
            // Auto-check phase status on load and every 5 seconds
            setTimeout(() => {
                if (document.getElementById('agent-forge').classList.contains('active')) {
                    checkAllPhases();
                    updateRealTrainingStatus();
                }
            }, 2000);
            
            // Auto-refresh status every 5 seconds if Agent Forge tab is active
            setInterval(() => {
                if (document.getElementById('agent-forge') && 
                    document.getElementById('agent-forge').classList.contains('active')) {
                    checkAllPhases();
                    updateRealTrainingStatus();
                }
            }, 5000);
        });
    </script>

    <!-- P2P/Fog Components Library -->
    <script src="../ui/components/p2p-fog-components.js"></script>

    <script>
        // Initialize P2P/Fog components when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize components for P2P Network tab
            if (document.getElementById('p2p-network-visualization')) {
                window.p2pNetworkStatus = new P2PNetworkStatus('p2p-network-visualization');
            }

            // Initialize components for Fog Computing tab
            if (document.getElementById('fog-resource-metrics')) {
                window.fogResourceChart = new FogResourceChart('fog-resource-metrics');
            }

            // Initialize components for Security & Privacy tab
            if (document.getElementById('privacy-security-dashboard')) {
                window.privacySecurityStatus = new PrivacySecurityStatus('privacy-security-dashboard');
            }

            // Initialize token economics widget if FOG tokens are displayed
            if (document.getElementById('fog-token-widget')) {
                window.tokenEconomicsWidget = new TokenEconomicsWidget('fog-token-widget');
            }
        });

        // Enhanced WebSocket message handling for P2P/Fog updates
        if (typeof socket !== 'undefined') {
            socket.addEventListener('message', function(event) {
                const data = JSON.parse(event.data);

                switch(data.type) {
                    case 'p2p_update':
                        if (window.p2pNetworkStatus) {
                            window.p2pNetworkStatus.updateStatus(data.data);
                        }
                        break;
                    case 'fog_update':
                        if (window.fogResourceChart) {
                            window.fogResourceChart.updateResources(data.data);
                        }
                        break;
                    case 'privacy_update':
                        if (window.privacySecurityStatus) {
                            window.privacySecurityStatus.updatePrivacyLevel(data.data);
                        }
                        break;
                    case 'token_update':
                        if (window.tokenEconomicsWidget) {
                            window.tokenEconomicsWidget.updateBalance(data.data);
                        }
                        break;
                }
            });
        }
    </script>
</body>
</html>
